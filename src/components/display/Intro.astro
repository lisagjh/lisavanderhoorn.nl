<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import { SplitText } from "gsap/SplitText";
  import { ScrambleTextPlugin } from "gsap/ScrambleTextPlugin";

  gsap.registerPlugin(ScrollTrigger, SplitText, ScrambleTextPlugin);

  // hide the frontend text
  gsap.set(".name-container", {
    position: "relative",
    display: "inline-block",
  });
  gsap.set(".frontend", {
    opacity: 0,
    y: -20,
    position: "absolute",
    top: 0,
    left: 0,
    whiteSpace: "nowrap",
  });

  const tl = gsap.timeline({ delay: 0.25 });

  tl.fromTo(
    ".intro h1 span.greeting",
    { opacity: 0, y: -20 },
    { opacity: 1, y: 0, duration: 1, ease: "power2.inOut" }
  );

  tl.fromTo(
    ".intro h1 span.name",
    { opacity: 0, y: -20 },
    { opacity: 1, y: 0, duration: 1, ease: "power2.inOut" }
  );

  tl.to(
    ".intro h1 span.name",
    {
      opacity: 0,
      y: -20,
      duration: 0.5,
      ease: "power2.inOut",
    },
    "+=3"
  )

    .to(".intro h1 span.frontend", {
      opacity: 1,
      y: 0,
      duration: 0.5,
      ease: "power2.inOut",
    })

    .to(
      ".word",
      {
        duration: 1.5,
        scrambleText: {
          text: "nerd",
          chars: "lowerCase",
          revealDelay: 0.3,
          speed: 0.4,
        },
      },
      "+=2"
    )

    .to(
      ".intro h1 span.frontend",
      {
        opacity: 0,
        y: -20,
        duration: 0.5,
        ease: "power2.inOut",
      },
      "+=3"
    )

    .to(".intro h1 span.name", {
      opacity: 1,
      y: 0,
      duration: 0.5,
      ease: "power2.inOut",
    });
</script>

<section class="intro">
  <h1>
    <span class="greeting">Hi! I'm</span>
    <div class="name-container">
      <span class="name">Lisa van der Hoorn</span>
      <span class="frontend">
        a frontend <span class="word">developer</span>
      </span>
    </div>
  </h1>
</section>

<style>
  section.intro {
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 1rem;
    padding: 0 4rem;
    width: 90%;
    max-width: 65rem;
    height: 75vh;
    animation: show 0.15s ease-in-out forwards;
  }

  @keyframes show {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  h1 {
    color: var(--primary);
    line-height: 1;
    display: block;
    overflow: visible;
  }

  h1 {
    font-size: 1.5rem;
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;

    & span {
      line-height: 1;
    }
  }

  h1 span.name,
  h1 span.frontend {
    font-size: 2.2rem;
  }

  @media (width >= 38rem) {
    h1 {
      font-size: 2.5rem;
    }

    h1 span.name,
    h1 span.frontend {
      font-size: 3.5rem;
    }
  }

  @supports (animation-timeline: view()) {
    section.intro {
      animation-timeline: view();
      animation-name: scale-out;
      animation-fill-mode: forwards;
      animation-range: 60% 100%;
    }

    @keyframes scale-out {
      from {
        scale: 1;
        opacity: 1;
        transform: translateY(0);
      }
      to {
        scale: 0.5;
        opacity: 0;
        transform: translateY(75%);
      }
    }
  }
</style>
